---
title: configurations
sidebarTitle: configurations
---

# `prefect.server.database.configurations`

## Classes

### `ConnectionTracker` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L59" target="_blank">↗</a></sup>


A test utility which tracks the connections given out by a connection pool, to
make it easy to see which connections are currently checked out and open.


**Methods:**

#### `track_pool` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L78" target="_blank">↗</a></sup>

```python
track_pool(self, pool: sa.pool.Pool) -> None
```

#### `on_connect` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L83" target="_blank">↗</a></sup>

```python
on_connect(self, adapted_connection: AdaptedConnection, connection_record: ConnectionPoolEntry) -> None
```

#### `on_close` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L92" target="_blank">↗</a></sup>

```python
on_close(self, adapted_connection: AdaptedConnection, connection_record: ConnectionPoolEntry) -> None
```

#### `on_close_detached` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L103" target="_blank">↗</a></sup>

```python
on_close_detached(self, adapted_connection: AdaptedConnection) -> None
```

#### `clear` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L113" target="_blank">↗</a></sup>

```python
clear(self) -> None
```

### `BaseDatabaseConfiguration` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L124" target="_blank">↗</a></sup>


Abstract base class used to inject database connection configuration into Prefect.

This configuration is responsible for defining how Prefect REST API creates and manages
database connections and sessions.


**Methods:**

#### `unique_key` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L171" target="_blank">↗</a></sup>

```python
unique_key(self) -> tuple[Hashable, ...]
```

Returns a key used to determine whether to instantiate a new DB interface.


#### `is_inmemory` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L200" target="_blank">↗</a></sup>

```python
is_inmemory(self) -> bool
```

Returns true if database is run in memory


#### `begin_transaction` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L204" target="_blank">↗</a></sup>

```python
begin_transaction(self, session: AsyncSession, with_for_update: bool = False) -> AbstractAsyncContextManager[AsyncSessionTransaction]
```

Enter a transaction for a session


### `AsyncPostgresConfiguration` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L211" target="_blank">↗</a></sup>

**Methods:**

#### `is_inmemory` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L374" target="_blank">↗</a></sup>

```python
is_inmemory(self) -> bool
```

Returns true if database is run in memory


### `AioSqliteConfiguration` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L380" target="_blank">↗</a></sup>

**Methods:**

#### `setup_sqlite` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L469" target="_blank">↗</a></sup>

```python
setup_sqlite(self, conn: DBAPIConnection, record: ConnectionPoolEntry) -> None
```

Issue PRAGMA statements to SQLITE on connect. PRAGMAs only last for the
duration of the connection. See https://www.sqlite.org/pragma.html for more info.


#### `begin_sqlite_conn` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L520" target="_blank">↗</a></sup>

```python
begin_sqlite_conn(self, conn: aiosqlite.AsyncAdapt_aiosqlite_connection) -> None
```

#### `begin_sqlite_stmt` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L529" target="_blank">↗</a></sup>

```python
begin_sqlite_stmt(self, conn: sa.Connection) -> None
```

#### `is_inmemory` <sup><a href="https://github.com/prefecthq/prefect/blob/main/src/prefect/server/database/configurations.py#L576" target="_blank">↗</a></sup>

```python
is_inmemory(self) -> bool
```

Returns true if database is run in memory

