version: 2
jobs:
  # ----------------------------------
  # Check formatting
  # ----------------------------------
  check_formatting:
    docker:
      - image: python:3.6

    steps:
      - checkout

      - run:
          name: Install Black
          command: pip install black

      - run:
          name: Run Black
          command: black --check .

  # ----------------------------------
  # Run unit tests in Python 3.4-3.7
  # ----------------------------------
  toxify:
    docker:
      - image: python:3.6

    steps:
      - checkout

      - run:
          name: Install Tox
          command: pip install tox

      - run:
          name: Run Tox
          command: tox

workflows:
  version: 2
  run_all:
    jobs:
      - check_formatting

      - toxify:
          requires:
            - check_formatting
